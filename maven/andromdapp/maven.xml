<project xmlns:j="jelly:core"
  		 xmlns:ant="jelly:ant"
  		 xmlns:velocity="jelly:velocity">
  		 
   <preGoal name="jar:jar">
    	<!-- replace the ${pom.currentVersion} in these
    		 files so we don't need to maintain them between
    		 different releases --> 
        <j:set var="pluginResources" value="plugin-resources/andromdapp"/>
		<j:set 
			var="pluginResourceJ2eeDir" 
			value="${pluginResources}/templates/j2ee-app"/>
	    <!-- merge all the versions in -->
	    <velocity:merge
			name="${maven.build.dest}/${pluginResourceJ2eeDir}/project-ejb.properties"
			basedir="${basedir}/${pluginResourceJ2eeDir}"
			template="/project-ejb.properties"/> 
	    <velocity:merge
			name="${maven.build.dest}/${pluginResourceJ2eeDir}/project-hibernate.properties"
			basedir="${basedir}/${pluginResourceJ2eeDir}"
			template="/project-hibernate.properties"/> 
        <ant:delete file="${maven.build.dest}/project.xml"/>
        <velocity:merge
            name="${maven.build.dest}/project.xml"
            basedir="${basedir}"
            template="/project.xml"/>   
        <!-- copy over the empty model -->
		<ant:copy 
		    file="${model.location}" 
		    todir="${maven.build.dest}/${pluginResourceJ2eeDir}/mda/src/uml"/>
		<!-- copy over the db initialization scripts for hibernate -->
        <ant:copy todir="${maven.build.dest}/${pluginResourceJ2eeDir}/hibernate/db/conf">
            <ant:fileset dir="${hibernate.db.conf.location}"/>
        </ant:copy>	
   </preGoal>

</project>
