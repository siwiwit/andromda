<project default="jar:install"
         xmlns:ant="jelly:ant"
         xmlns:j="jelly:core">

    <!-- ==================================================================
             Generator the PDF documentation
         ================================================================== -->
    <postGoal name="xdoc">
        <!-- copy over the online store example model -->
        <ant:copy todir="${maven.docs.dest}">
            <ant:fileset dir="../../samples/online-store/mda/src/uml"/>
        </ant:copy>
        <!-- we want to generate a pdf from the documentation -->
        <attainGoal name="fo:fo"/>
        <attainGoal name="pdf:pdf"/>
    </postGoal>

    <postGoal name="java:compile">
        <ant:mkdir dir="${maven.build.dest}/resources/WEB-INF/lib"/>
        <!-- Include the taglib code into the resources after compilation -->
        <ant:copy file="${maven.repo.local}/${pom.groupId}/jars/andromda-breadcrumbs-taglib-${pom.currentVersion}.jar"
            tofile="${maven.build.dest}/resources/WEB-INF/lib/andromda-breadcrumbs-taglib.jar"/>
        <ant:copy file="${maven.repo.local}/${pom.groupId}/jars/andromda-formatting-taglib-${pom.currentVersion}.jar"
            tofile="${maven.build.dest}/resources/WEB-INF/lib/andromda-formatting-taglib.jar"/>
    </postGoal>

    <preGoal name="generate-source">
        <j:set var="maven.andromda.model.uri" value="${metafacade.model.uri}"/>
        <j:set var="maven.andromda.modelValidation" value="${metafacade.modelValidation}" defaultValue="true"/>
        <j:set var="maven.andromda.cartridgeFilter" value="${metafacade.cartridgeFilter}"/>
        <j:set var="maven.andromda.modelPackage.0.name" value="${metafacade.modelPackage.0.name}"/>
        <j:set var="maven.andromda.modelPackage.0.shouldProcess" value="${metafacade.modelPackage.0.shouldProcess}"/>
    </preGoal>

</project>


