<?xml version="1.0" encoding="UTF-8"?>

<project name="generate-uml2-metamodel" basedir="." default="generate">
        
    <target name="generate">
        
        <property name="storageDir" value="${basedir}/target"/>
        <property name="storageFile" value="mdr"/>    
        <property name="xmi.file" value="uml-2.0"/>    
        
        <taskdef name="mdr" classname="org.netbeans.mdrant.MdrTask">
            <classpath>
                <pathelement path="${depClasspath}"/>
            </classpath>
        </taskdef>     
        
        <mkdir dir="${storageDir}"/>
        <mkdir dir="${storageDir}/src/java"/>
        <mkdir dir="${storageDir}/xmi"/>   
        
        <property name="modelDirectory" value="${storageDir}/metamodel"/>
        <copy todir="${modelDirectory}">
            <fileset dir="${basedir}/src/main/xmi"/>
        </copy>    
        
        <mdr storageFile="${storageDir}/${storageFile}">
            <instantiate name="mof4models"/>
            <readXMI 
                file="${modelDirectory}/${xmi.file}.xml"
                extent="mof4models"/>
            <writeXMI 
                file="${storageDir}/xmi/${xmi.file}.xml" 
                extent="mof4models"
                xmiVersion = "1.2"/>                
            <writeDTD 
                file="${storageDir}/xmi/${xmi.file}.dtd" 
                extent="mof4models"/>                                    
            <mapJava
                dir="${storageDir}/src/java" 
                extent="mof4models"/>               
            <instantiate 
                name="uml"
                extent="mof4models"
                package="UML2"/>    
            <printExtentNames/>
        </mdr>
    </target>
    
</project>