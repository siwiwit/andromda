<project default="install"
         xmlns:ant="jelly:ant"
         xmlns:j="jelly:core">

	<ant:property environment="env"/>
	
    <!-- The location of the database configuration scripts -->
    <j:set var="hibernate.db.conf.location" value="${basedir}/../core/db/conf"/>

  	<goal name="deploy" prereqs="ear:ear">
  		<ant:copy file="${maven.build.dir}/${maven.final.name}.ear"
  			todir="${env.JBOSS_HOME}/server/${jboss.config}/deploy"/>
  	</goal> 
  	
  	<goal name="undeploy">
  		<ant:delete 
  			file="${env.JBOSS_HOME}/server/${jboss.config}/deploy/${maven.final.name}.ear"/>
  	</goal> 
  	
  	<postGoal name="ear:install">
        <!-- copy the db scripts over to the target directory -->
        <ant:copy todir="${maven.build.dir}">
        	<ant:fileset dir="${hibernate.db.conf.location}"/>
        </ant:copy>
  	</postGoal>
  	  	
</project>
