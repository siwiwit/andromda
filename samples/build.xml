<project name="AndroMDASamples" default="dist">

    <!-- ============================================================= -->
    <!--               Directory settings                              -->
    <!-- ============================================================= -->

    <!-- destination directories -->
    <property name="dist.dir"         value="dist"   />
    <property file="build.properties" />

    <!-- ============================================================= -->
    <!--               Internal targets                                -->
    <!-- ============================================================= -->

    <target name="buildComponent">
        <ant inheritAll="false" dir="${basedir}/${component.name}" target="dist">
          <property name="dist.stage.dir" location="${dist.dir}/samples/${component.name}"/>
          <property name="andromda.home" location="${andromda.home}" />
          <property name="jboss.home" location="${jboss.home}" />
        </ant>
        <move taskname="${component.name}" todir="${dist.dir}">
          <fileset dir="${basedir}/${component.name}/dist">
            <include name="*.*"/>
          </fileset>
        </move>
    </target>

	<target name="cleanComponent">
		<echo message="cleanComponent ${component.name}"/>
        <ant inheritAll="false" dir="${basedir}/${component.name}" target="clean" />
    </target>
    
    <!-- ============================================================= -->
    <!--               Highlevel user tasks                            -->
    <!-- ============================================================= -->

    <!-- Setup directory structure -->
    <target name="init">
        <tstamp/>
        <mkdir dir="${dist.dir}"/>
    </target>

    <!-- Remove directory structure -->
    <target name="clean" description="Removes all generated files">
        <delete includeEmptyDirs="true" quiet="true">
            <fileset dir="${dist.dir}"/>
        </delete>
        
        <antcall target="cleanComponent">
          <param name="component.name" value="car-rental-system"/>
        </antcall>

        <antcall target="cleanComponent">
          <param name="component.name" value="model-report"/>
        </antcall>
        
    </target>

    <target name="dist" depends="clean,init"
            description="Builds all samples">

        <antcall target="buildComponent">
          <param name="component.name" value="car-rental-system"/>
        </antcall>

        <antcall target="buildComponent">
          <param name="component.name" value="model-report"/>
        </antcall>

    </target>

</project>
