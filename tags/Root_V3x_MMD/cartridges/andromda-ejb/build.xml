<project name="andromda-ejb" default="dist">

    <!-- ============================================================= -->
    <!--               Directory settings                              -->
    <!-- ============================================================= -->

	<property file="build.properties"/>
	<property file="build.properties.sample"/>
    <property name="src.dir"                   value="src" />
    <property name="build.dir"                 value="build" />
    <property name="dist.dir"                  value="dist" />
    <property name="andromda.home"  value="../../dist" />
    
    <path id="build.classpath">
      <pathelement path="${andromda.home}/andromda-core/andromda.jar"/>
      <fileset dir="${andromda.home}/andromda-core/lib" includes="*.jar"/>
    </path>

    <!-- Setup directory structure -->
    <target name="init">
        <tstamp/>
        <mkdir dir="${dist.dir}"/>
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${build.dir}/classes"/>
    </target>

    <!-- Remove directory structure structure -->
    <target name="clean" description="Removes all generated files">
        <delete includeEmptyDirs="true" quiet="true">
            <fileset dir="${dist.dir}"/>
            <fileset dir="${build.dir}"/>
        </delete>
    </target>

    <!-- ============================================================= -->
    <!--               Highlevel user tasks                            -->
    <!-- ============================================================= -->

    <target name="dist" depends="clean,build"
            description="Builds the distribution structure">
      <copy todir="${dist.dir}" >
          <fileset dir="${build.dir}" includes="*.jar" />
          <fileset dir="." includes="andromda-ejb.properties" />
      </copy>
    </target>

    <target name="build" depends="init"
            description="Builds the objects from the sources">
        <javac srcdir="${src.dir}" destdir="${build.dir}/classes"
                   debug="${build.debug}" optimize="${build.optimize}">
          <classpath refid="build.classpath"/>
          <include name="**/*.java" />
        </javac>
        <jar jarfile="${build.dir}/andromda-ejb.jar">
            <fileset dir="${src.dir}" includes="**/*" excludes="**/*.java"/>
            <fileset dir="${build.dir}/classes" includes="**/*.class" />
        </jar>
    </target>

</project>
