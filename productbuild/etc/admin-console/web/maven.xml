<project default="war:install"
    xmlns:ant="jelly:ant"
    xmlns:maven="jelly:maven">

    <ant:property environment="env"/>

    <goal name="deploy" prereqs="war:war">
        <ant:copy file="${maven.build.dir}/${pom.artifactId}.war"
                  todir="${env.JBOSS_HOME}/server/${jboss.config}/deploy"/>
    </goal>

    <goal name="undeploy">
        <ant:delete file="${env.JBOSS_HOME}/server/${jboss.config}/deploy/${pom.artifactId}.war"/>
    </goal>

    <!-- =====================================================================
            Add the generated code on the classpath
         ===================================================================== -->
    <preGoal name="java:compile">
        <ant:path
            id="andromda.struts.gen.src"
            location="${maven.build.src}"/>
        <maven:addPath
            id="maven.compile.src.set"
            refid="andromda.struts.gen.src"/>
    </preGoal>

    <postGoal name="war:init">
        <ant:copy todir="${maven.build.src}">
            <ant:fileset dir="${maven.src.dir}/jsp"/>
            <ant:fileset dir="${maven.src.dir}/properties"/>
        </ant:copy>
    </postGoal>

    <postGoal name="war:webapp">
        <ant:copy todir="${maven.war.webapp.dir}">
            <ant:fileset dir="${maven.build.src}">
                <ant:include name="**/*.gif"/>
                <ant:include name="**/*.png"/>
                <ant:include name="**/*.jpg"/>
                <ant:include name="**/*.js"/>
                <ant:include name="**/*.jsp"/>
                <ant:include name="**/*.jspf"/>
                <ant:include name="**/*.css"/>
                <ant:include name="WEB-INF/**/*"/>
            </ant:fileset>
        </ant:copy>
    </postGoal>

</project>
